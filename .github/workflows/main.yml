    1 name: OtoFon Dinamik Analiz
    2
    3 on:
    4   push:
    5     branches:
    6       - main
    7       - ana
    8   schedule:
    9     - cron: '15 8 * * 1-5'
   10   workflow_dispatch:
   11
   12 jobs:
   13   tarama:
   14     runs-on: ubuntu-latest
   15     steps:
   16       - name: Depoyu Kopyala
   17         uses: actions/checkout@v4
   18
   19       - name: Python Kurulumu
   20         uses: actions/setup-python@v4
   21         with:
   22           python-version: '3.10'
   23
   24       - name: Bağımlılıkları Yükle
   25         run: |
   26           python -m pip install --upgrade pip
   27           if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
   28           pip install ruff
   29
   30       - name: Kod Kalitesini Kontrol Et
   31         run: ruff check . --output-format=github || echo "Linting hataları bulundu, devam ediliyor..."
   32         continue-on-error: true
   33
   34       - name: Adım 1 - Tarama
   35         run: python -u tarama_script.py weekly 2
   36
   37       - name: Tarama Sonuclarini Kaydet
   38         if: always()
   39         uses: actions/upload-artifact@v4
   40         with:
   41           name: tarama-sonuclari-${{ github.run_id }}
   42           path: |
   43             *.xlsx
   44             *.txt
   45
   46   analiz:
   47     needs: tarama
   48     runs-on: ubuntu-latest
   49     steps:
   50       - name: Depoyu Kopyala
   51         uses: actions/checkout@v4
   52
   53       - name: Python Kurulumu
   54         uses: actions/setup-python@v4
   55         with:
   56           python-version: '3.10'
   57
   58       - name: Bağımlılıkları Yükle
   59         run: |
   60           python -m pip install --upgrade pip
   61           if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
   62
   63       - name: Tarama Sonuclarini Indir
   64         uses: actions/download-artifact@v4
   65         with:
   66           name: tarama-sonuclari-${{ github.run_id }}
   67
   68       - name: Adım 2 - Analiz
   69         run: python -u analiz_script.py
   70
   71       - name: Analiz Sonuclarini Kaydet
   72         if: always()
   73         uses: actions/upload-artifact@v4
   74         with:
   75           name: analiz-sonuclari-${{ github.run_id }}
   76           path: |
   77             *.xlsx
   78             *.txt
